<html>
  <head></head>
  <body>
    <div id="simmons"></div>
	
	<script src="libs/Box2dWeb-2.1.a.3.js"></script> 	<!--将box2d转为js--> 
	<script src="libs/crafty.js"></script>
	<script src="libs/box2d.js"></script>	<!--集成box2d和crafty-->
	
    <script>
		var world,
			PTM_RATIO = 32,
			canvas_w = 600,				// 背景宽
			canvas_h = canvas_w,		// 背景高
			circle_d = 500,				// 圆直径
			point_d = 25,				// 点直径
			point_r = point_d/2,		// 点半径
			circle_r = circle_d/2,		// 圆直径
			circle_x = point_r,			// 圆左上角x轴坐标
			circle_y = circle_x,		// 圆左上角y轴坐标
			point1_x = circle_r,		// 点1左上角x轴坐标
			point1_y = 0				// 点1左上角y轴坐标
			;
			
		window.onload = function () {
			gameInit();
		};

		gameInit = function(){
			//start crafty
			Crafty.init(canvas_w, canvas_h);
			Crafty.canvas.init();
			//Crafty.background('#000000 url(img/ball.png) no-repeat center center');  // 方案2 变通的实现画圆
			Crafty.background('#000000');	// FOR TEST
			// The first parameter is the gravity along the x-axis. In this case 0, otherwise we would be pulled to the side.
			// The second parameter is the gravity along the y-axis. I’ve set it to 10. This will make all physics objects fall down.
			// The third parameter is the “pixel-to-meter” ratio. I’ve set it to 32. That means that 32 pixels = 1 meter in the game.
			// The fourth parameter will allow bodies to “sleep” when they are inactive. It’s best to leave this to true for performance. 
			Crafty.box2D.init(0,0, PTM_RATIO, true); 
			world = Crafty.box2D.world;
			//Start the Box2D debugger
			Crafty.box2D.showDebugInfo();  
			
			Crafty.scene("main", function () {				
				generateWorld();     
			});
			
			Crafty.scene("main");
		}

		generateWorld = function() {	
			genterateShape();	
		}

		genterateShape = function(){
				// 实现模型：在正方形框中画圆
				var circle =  Crafty.e("2D, Canvas, Color, Box2D")
											.origin("center")	// 居中
											//.image("img/ball.png", "repeat");	// TODO:使用图片填充
											.color("#FFFFFF")	// Canvas颜色
											.attr({ 
												x: circle_x, 	// 左上角x轴坐标
												y: circle_y, 	// 左上角y轴坐标
												h: circle_d,	// 矩形高
												w: circle_d 	// 矩形宽
											})
											.box2d({					// 在Box2D中，无法设置填充刚体所用的颜色，默认有三中颜色来填充刚体，即红色（表示正在移动的刚体），绿色（表示静止的刚体，没有密度质量的刚体），灰色（表示已经处于休眠状态的刚体）。
													bodyType: "static", // static:固定 dynamic:掉落下来
													density : 1.0,
													friction : 2,
													restitution : 0.2,
													shape: "circle"		// Box2D是无法创建空心球体的，只能通过多边形来近似模拟空心圆
											});
				// 在圆心以上圆半径高度的圆周上画个小圆点							
				var point1 =  Crafty.e("2D, Canvas, Color, Box2D")
							.origin("center")	
							.color("#FFFFFF")	
							.attr({ 
								x: point1_x, 
								y: point1_y, 
								h: point_d,	
								w: point_d 	
							})
							.box2d({					
									bodyType: "static", 
									density : 1.0,
									friction : 2,
									restitution : 0.2,
									shape: "circle"		
							});
				

		}
					
    </script>
  </body>
</html>